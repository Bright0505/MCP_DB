# MCP Multi-Database Connection Configuration
# Copy this file to .env and fill in your database credentials

# ===========================================
# ENVIRONMENT FILE CONFIGURATION (Optional)
# ===========================================
# Custom path to .env file (optional, auto-detected by default)
# ENV_FILE_PATH=/custom/path/.env

# ===========================================
# DATABASE TYPE SELECTION
# ===========================================
# Choose your database type: "mssql" or "postgresql"
DB_TYPE=mssql

# ===========================================
# UNIVERSAL DATABASE SETTINGS
# ===========================================
# These settings work for both database types
# Only modify DB_TYPE and these variables to switch databases

# Database connection settings
DB_HOST=localhost
DB_NAME=your_database_name
DB_USER=your_username
DB_PASSWORD=your_password
DB_PORT=1433
DB_TIMEOUT=30
# DB_COMMAND_TIMEOUT=60  # Async database command timeout in seconds (default: 60)


# For PostgreSQL: set DB_SCHEMA and DB_SSLMODE
# For SQL Server: these are ignored
DB_SCHEMA=public
DB_SSLMODE=prefer

# ===========================================
# EXAMPLE CONFIGURATIONS
# ===========================================

# Example 1: SQL Server
# DB_TYPE=mssql
# DB_HOST=192.168.1.100
# DB_NAME=CompanyDB
# DB_USER=dbuser
# DB_PASSWORD=secure_password
# DB_PORT=1433

# Example 2: PostgreSQL
# DB_TYPE=postgresql
# DB_HOST=postgres.company.com
# DB_NAME=analytics_db
# DB_USER=analyst
# DB_PASSWORD=secure_password
# DB_PORT=5432
# DB_SCHEMA=public
# DB_SSLMODE=require

# ===========================================
# ADVANCED DATABASE-SPECIFIC SETTINGS
# ===========================================
# SQL Server advanced options (only used when DB_TYPE=mssql)
# ODBC Driver (optional, auto-detected if not set)
# Auto-detection priority: Driver 18 > Driver 17 > Driver 13
# MSSQL_DRIVER=ODBC Driver 18 for SQL Server
MSSQL_ENCRYPT=true
MSSQL_TRUST_CERTIFICATE=true
# MSSQL_TRUSTED_CONNECTION=true  # Alternative to username/password auth

# Note: Connection settings (server, database, user, password, port)
# are controlled by the universal DB_* variables above.
# Use MSSQL_* only for SQL Server-specific features.

# ===========================================
# QUERY LIMITS CONFIGURATION
# ===========================================
# Maximum SQL query length in characters (default: 50000)
# MAX_QUERY_LENGTH=50000

# Maximum LIMIT value for query results (default: 10000)
# MAX_QUERY_LIMIT=10000

# ===========================================
# SCHEMA CACHING AND PRELOAD CONFIGURATION
# ===========================================
# Enable schema caching for improved performance
SCHEMA_ENABLE_CACHE=true

# Cache time-to-live in minutes
SCHEMA_CACHE_TTL_MINUTES=60

# Enable automatic schema preload on startup
SCHEMA_PRELOAD_ON_STARTUP=true

# Path to schema configuration file (relative to project root)
SCHEMA_CONFIG_PATH=schema-config.json

# Enable parallel preloading for faster startup
SCHEMA_PARALLEL_PRELOAD=true

# Maximum concurrent queries for preloading
SCHEMA_MAX_CONCURRENT_QUERIES=5

# ===========================================
# MCP SERVER CONFIGURATION
# ===========================================
# MCP server name identifier (default: mcp-db)
# MCP_SERVER_NAME=mcp-db

# Tool name prefix (default: posdb). Tools will be named {prefix}_query, {prefix}_schema, etc.
# TOOL_PREFIX=posdb

# ===========================================
# HTTP SERVER CONFIGURATION
# ===========================================
HTTP_HOST=0.0.0.0
HTTP_PORT=8000

# 環境標識 (development 或 production)
ENVIRONMENT=development

# CORS 設定（生產環境必須明確設定）
# 開發環境會自動使用 localhost:3000 和 localhost:8000
# 生產環境如果未設定則禁用 CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# CORS preflight 快取時間（秒）
# CORS_PREFLIGHT_MAX_AGE=600  # 預設：600 秒（10 分鐘）

# 速率限制設定
# RATE_LIMIT_DEFAULT=100/minute  # 全局速率限制（預設：100/minute）
# RATE_LIMIT_QUERY=30/minute     # 查詢端點速率限制（預設：30/minute）

# ===========================================
# DATABASE SWITCHING GUIDE
# ===========================================
#
# Quick Switch Examples:
#
# Switch to PostgreSQL:
# 1. Change: DB_TYPE=postgresql
# 2. Update: DB_PORT=5432
# 3. Set: DB_SCHEMA=public, DB_SSLMODE=prefer
#
# Switch to SQL Server:
# 1. Change: DB_TYPE=mssql
# 2. Update: DB_PORT=1433
# 3. Configure: MSSQL_ENCRYPT=true, MSSQL_TRUST_CERTIFICATE=true
#
# ===========================================
# TROUBLESHOOTING GUIDE
# ===========================================
#
# SQL Server Issues:
# - SSL Error: Set MSSQL_TRUST_CERTIFICATE=true
# - Connection timeout: Check firewall and SQL Server network config
# - Auth error: Verify DB_USER and DB_PASSWORD
#
# PostgreSQL Issues:
# - SSL Error: Set DB_SSLMODE=disable for testing
# - Connection refused: Check PostgreSQL service and pg_hba.conf
# - Auth error: Verify user exists and has proper permissions
#
# General Issues:
# - Network: Test with: ping DB_HOST
# - Port: Test with: telnet DB_HOST DB_PORT
# - Credentials: Verify in database management tool first